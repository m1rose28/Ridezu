<!DOCTYPE html>

<html lang="en">
<head>

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>Ridezu Test Tool</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<link type="text/css" rel="stylesheet" href="../css/style.css">
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
	<script type="text/javascript" src="../js/ridezu.js"></script>
	<link type="text/css" rel="stylesheet" href="../css/ridezu.css">
</head>

<body>

	<div id="w">
		
		<div id="pagebody" style="left: 0px; ">
			<header id="toolbarnav" style="left: 0px; ">
				<a href="index.htm#navmenu" id="menu-btn"></a>
			
				<h1 id="pTitle">Ridezu Services Test Page</h1>
			</header>
			
			<section id="content">
			<div class="leftside">
	
<script>

// this function set 2 creates a new user
		var retval="";					
		function regnewuser(){

        fbid=document.getElementById("regfbid").value;
        fname=document.getElementById("regfname").value;
        lname=document.getElementById("reglname").value;
        email=document.getElementById("regemail").value;
        hadd1=document.getElementById("reghadd1").value;
        hcity=document.getElementById("reghcity").value;
        hstate=document.getElementById("reghstate").value;
        hzip=document.getElementById("reghzip").value;
    	wadd1=document.getElementById("regwadd1").value;
        wcity=document.getElementById("regwcity").value;
        wstate=document.getElementById("regwstate").value;
        wzip=document.getElementById("regwzip").value;       
        hlat=document.getElementById("reghlat").value;
        hlng=document.getElementById("reghlng").value;
        wlat=document.getElementById("regwlat").value;
        wlng=document.getElementById("regwlng").value;

			var dataset = {
				"fbid":	fbid,
				"fname": fname,
				"lname": lname,
				"add1": hadd1,
				"city": hcity,
				"state": hstate,	
				"zip": hzip,
				"email": email,
				"workadd1": wadd1,
				"workcity": wcity,
				"workstate": wstate,	
				"workzip": wzip,
				"email": email,
				"homelatlong": hlat+","+hlng,
				"worklatlong": wlat+","+wlng,
				}
				
			var jsondataset = JSON.stringify(dataset);
		
		    var request=$.ajax({
                url: "http://ec2-50-18-0-33.us-west-1.compute.amazonaws.com/ridezu/api/users",
                type: "POST",
                dataType: "json",
                data: jsondataset,
                success: function(data) {show(data);},
                error: function(data) { alert("boo!"+JSON.stringify(data)); },
                beforeSend: setHeader
            });
            
            request.done(function(msg) {
  				localStorage.seckey=msg.seckey;
				});      	
       	}

		function getusers(){
		    var request=$.ajax({
                url: "http://ec2-50-18-0-33.us-west-1.compute.amazonaws.com/ridezu/api/users",
                type: "GET",
                dataType: "json",
                success: function(data) {show(data);},
                error: function(data) { alert("boo!"+JSON.stringify(data)); },
                beforeSend: setHeader
            });
        }

//get all rides
		function getallrides(){
		    var request=$.ajax({
                url: "http://ec2-50-18-0-33.us-west-1.compute.amazonaws.com/ridezu/api/v/1/rides",
                type: "GET",
                dataType: "json",
                success: function(data) {show(data); },
                error: function(data) { alert("boo!"+JSON.stringify(data)); },
                beforeSend: setHeader
            });
        }

//get driver by time
		function getdriverbytime(){
        	time=document.getElementById("getdrivertime").value;
            url: "http://ec2-50-18-0-33.us-west-1.compute.amazonaws.com/ridezu/api/rides/v/1/search/eventtime/"+time+"/driver";
		    var request=$.ajax({
                url: url,
                type: "GET",
                dataType: "json",
                success: function(data) {show(data); },
                error: function(data) { alert("boo!"+JSON.stringify(data)); },
                beforeSend: setHeader
            });
        }

//get rider by time
		function getriderbytime(){
        	time=document.getElementById("getridertime").value;
            url="http://ec2-50-18-0-33.us-west-1.compute.amazonaws.com/ridezu/api/v/1/rides/search/eventtime/"+time+"/rider";
		    var request=$.ajax({
                url: url,
                type: "GET",
                dataType: "json",
                success: function(data) {show(data);},
                error: function(data) { alert("boo!"+JSON.stringify(data)); },
                beforeSend: setHeader
            });
        }


//get ride by id
		function getridebyid(){
        	rideid=document.getElementById("rideid").value;
		    url= "http://ec2-50-18-0-33.us-west-1.compute.amazonaws.com/ridezu/api/v/1/rides/"+rideid;
		    var request=$.ajax({
                url: url,
                type: "GET",
                dataType: "json",
                success: function(data) {show(data); },
                error: function(data) { alert("boo!"+JSON.stringify(data)); },
                beforeSend: setHeader
            });
        }

//get rider avail rides by fbid
		function getridebyfbid(){
        	fbid=document.getElementById("ridebyfbid").value;
		    url="http://ec2-50-18-0-33.us-west-1.compute.amazonaws.com/ridezu/api/v/1/rides/search/fbid/"+fbid+"/driver";
		    var request=$.ajax({
                url: url,
                type: "GET",
                dataType: "json",
                success: function(data) {show(data); },
                error: function(data) { alert("boo!"+JSON.stringify(data)); },
                beforeSend: setHeaderUser
            });
        }

//get rider avail rides by fbid,route,date
		function getridebyfbidRtDt(){
        	fbid=document.getElementById("ridebyfbid").value;
			route=document.getElementById("ridebyroute").value;
			date=document.getElementById("ridebydate").value;
		    url="http://ec2-50-18-0-33.us-west-1.compute.amazonaws.com/ridezu/api/v/1/rides/search/fbid/"+fbid+"/searchroute/"+route+"/searchdate/"+date+"/driver";
		    var request=$.ajax({
                url: url,
                type: "GET",
                dataType: "json",
                success: function(data) {show(data); },
                error: function(data) { alert("boo!"+JSON.stringify(data)); },
                beforeSend: setHeaderUser
            });
        }

//get driver avail rides by fbid
		function getdriverbyfbid(){
        	fbid=document.getElementById("drivebyfbid").value;
		    url="http://ec2-50-18-0-33.us-west-1.compute.amazonaws.com/ridezu/api/v/1/rides/search/fbid/"+fbid+"/rider";
		    var request=$.ajax({
                url: url,
                type: "GET",
                dataType: "json",
                success: function(data) {show(data); },
                error: function(data) { alert("boo!"+JSON.stringify(data)); },
                beforeSend: setHeaderUser
            });
        }

//get driver avail rides by fbid,route,date
		function getdriverbyfbidRtDt(){
        	fbid=document.getElementById("drivebyfbid").value;
		route=document.getElementById("ridebyroute").value;
		date=document.getElementById("ridebydate").value;

		    url="http://ec2-50-18-0-33.us-west-1.compute.amazonaws.com/ridezu/api/v/1/rides/search/fbid/"+fbid+"/searchroute/"+route+"/searchdate/"+date+"/rider";
		    var request=$.ajax({
                url: url,
                type: "GET",
                dataType: "json",
                success: function(data) {show(data); },
                error: function(data) { alert("boo!"+JSON.stringify(data)); },
                beforeSend: setHeaderUser
            });
        }


//this is for a rider requesting a ride in an empty spot
		function requestnewride(){
        	fbid=document.getElementById("reqridefbid").value;
        	time=document.getElementById("reqridetime").value;
        	route=document.getElementById("reqrideroute").value;
        	
            url="http://ec2-50-18-0-33.us-west-1.compute.amazonaws.com/ridezu/api/v/1/rides/rider";

			var dataset = {
				"fbid":	fbid,
				"eventtime": time,
				"route": route
				}				

			var jsondataset = JSON.stringify(dataset);

		    var request=$.ajax({
                url: url,
                type: "POST",
                dataType: "json",
                data: jsondataset,
                success: function(data) {show(data); },
                error: function(data) {alert("boo!"+JSON.stringify(data)); },
                beforeSend: setHeader
            });
        }




//this is for a driver posting a new ride 

		function postnewride(){
        	fbid=document.getElementById("postridefbid").value;
        	time=document.getElementById("postridetime").value;
			route=document.getElementById("route").value;
			var dataset = {
				"fbid":	fbid,
				"eventtime": time,
				"route": route,
				}				

			var jsondataset = JSON.stringify(dataset);

		    var request=$.ajax({
                url: "http://ec2-50-18-0-33.us-west-1.compute.amazonaws.com/ridezu/api/v/1/rides/driver",
                type: "POST",
                dataType: "json",
                data: jsondataset,
                success: function(data) {show(data); },
                error: function(data) {alert("boo!"+JSON.stringify(data)); },
                beforeSend: setHeader
            });
        }

function postnewridewithrider(){
fbid=document.getElementById("driverfbid").value;
rideid=document.getElementById("reqrideid").value;
var dataset = {
				"fbid":	fbid,
		}				
	var jsondataset = JSON.stringify(dataset);
		url="http://ec2-50-18-0-33.us-west-1.compute.amazonaws.com/ridezu/api/v/1/rides/rideid/"+rideid+"/driver";
		    var request=$.ajax({
                url: url,
                type: "PUT",
                dataType: "json",
                data: jsondataset,
                success: function(data) {show(data); },
                error: function(data) {alert("boo!"+JSON.stringify(data)); },
                beforeSend: setHeader
            });

		
}


//this is for a rider selecting a ride with a driver (rideid is the match) 

		function selectridebyrider(){
		fbid=document.getElementById("selectridefbid").value;
        rideid=document.getElementById("selectrideid").value;
		var dataset = {
				"fbid":	fbid,
				}				
			
			var jsondataset = JSON.stringify(dataset);

			url="http://ec2-50-18-0-33.us-west-1.compute.amazonaws.com/ridezu/api/v/1/rides/rideid/"+rideid+"/rider";
		    var request=$.ajax({
                url: url,
                type: "PUT",
                dataType: "json",
                data: jsondataset,
                success: function(data) {show(data); },
                error: function(data) {alert("boo!"+JSON.stringify(data)); },
                beforeSend: setHeader
            });
        }

//this is for setting headers / authentication.  temporarily turned off.  


        function setHeader(xhr) {
            xhr.setRequestHeader("X-Signature", "f8435e6f1d1d15f617c6412620362c21");
            xhr.setRequestHeader("Content-Type", "application/json");
        }

        function setHeaderUser(xhr) {
            xhr.setRequestHeader("X-Signature", "5f058776ed7361b23b997434d051b064");
            xhr.setRequestHeader("Content-Type", "application/json");
        }
        
//this shows the actual json result

        function show(data){
        	x=JSON.stringify(data)
        	document.getElementById("jsonresult").innerHTML=x;
			}
        
        function shownewuser(){
        	document.getElementById("makenewuser").style.display="block";
			}

        function hidenewuser(){
        	document.getElementById("makenewuser").style.display="none";
			}        
</script>

<style>
.row{
padding:15px;
background-color:#eeeeee;
border-bottom:1px solid #cccccc;
}
.inset{
margin:10px;
margin-left:30px;
padding:15px;
background-color:#dddddd;
border:1px solid #cccccc;
overflow:auto;
}
.btn {
font-size:12px;
padding:5px;
background-color:#009600;
color: #ffffff;
margin-left:20px;
}



</style>

<div class="row"><a class="btn" onclick="shownewuser();">Make a new user</a>
	 <div id="makenewuser" style="display:none;" class="inset"/>	 
			<div class="row">fbid: <input id="regfbid" value="504711218" type="text"/></div>
			<div class="row">first name: <input id="regfname" value="Mark" type="text"/></div>
			<div class="row">last name:  <input id="reglname" value="Rose" type="text"/></div>
			<div class="row">email:  <input id="regemail" value="m1rose28@gmail.com" type="text"/></div>
			<div class="row">home address 1:  <input id="reghadd1" value="5475 Tesoro Court" type="text"/></div>
			<div class="row">home city:  <input id="reghcity" value="San Jose" type="text"/></div>
			<div class="row">home state:  <input id="reghstate" value="CA" type="text"/></div>
			<div class="row">home zip:  <input id="reghzip" value="95124" type="text"/></div>
			<div class="row">work address 1:  <input id="regwadd1" value="500 Unviversity" type="text"/></div>
			<div class="row">work city:  <input id="regwcity" value="Los Gatos" type="text"/></div>
			<div class="row">work state:  <input id="regwstate" value="CA" type="text"/></div>
			<div class="row">work zip:  <input id="regwzip" value="95132" type="text"/></div>
			<div class="row">home lat:  <input id="reghlat" value="" type="37.2388541"/></div>
			<div class="row">home lng:  <input id="reghlng" value="" type="-121.9214275"/></div>
			<div class="row">work lat:  <input id="regwlat" value="" type="text"/></div>
			<div class="row">work lng:  <input id="regwlng" value="" type="text"/></div>
			<div class="row"><a class="btn" onclick="regnewuser();">Create</a>  <a onclick="hidenewuser();">hide</a></div>
	 </div> 
</div>
<div class="row"><a class="btn" onclick="getusers();">Get all users</a></div>
<div class="row"><a class="btn" onclick="getallrides();">Get all rides</a></div>
<div class="row"><input id="rideid" value="rideid" type="text"/><a class="btn" onclick="getridebyid();">Get a ride by id</a></div>
<div class="row"><input id="ridebyfbid" value="fbid" type="text"/><a class="btn" onclick="getridebyfbid();">Get list of drivers (Pass fbid of rider making the API call)</a></div>
<div class="row"><input id="ridebyfbid" value="fbid" type="text"/><input id="ridebyroute" value="h2w" type="text"/><input id="ridebydate" value="2012-10-5" type="text"/><a class="btn" onclick="getridebyfbidRtDt();">Get list of drivers 2 (Pass fbid of rider making the API call,route, eventtime)</a></div>

<div class="row"><input id="drivebyfbid" value="fbid" type="text"/><a class="btn" onclick="getdriverbyfbid();">Get list of rider requests (Pass fbid of driver making the API call)</a></div>
<div class="row"><input id="drivebyfbid" value="fbid" type="text"/><input id="ridebyroute" value="h2w" type="text"/><input id="ridebydate" value="2012-10-5" type="text"/><a class="btn" onclick="getdriverbyfbidRtDt();">Get list of rider requests 2(Pass fbid of driver making the API call,route, eventtime )</a></div>


<div class="row"><input id="reqridefbid" value="fbid" type="text"/><input id="reqrideroute" value="h2w" type="text"/><input id="reqridetime" value="2012-09-27 10:00" type="text"/><a class="btn" onclick="requestnewride();">Request a ride (empty)</a></div>
<div class="row"><input id="selectridefbid" value="fbid" type="text"/><input id="selectrideid" value="rideid" type="text"/><a class="btn" onclick="selectridebyrider();">Request a ride (w/specific driver)</a></div>
<div class="row"><input id="postridefbid" value="fbid" type="text"/><input id="route" value="h2w" type="text"/><input id="postridetime" value="2012-09-27 10:00" type="text"/><a class="btn" onclick="postnewride();">Post a Ride (empty)</a></div>
<div class="row"><input id="driverfbid" value="driver fbid" type="text"/><input id="reqrideid" value="rideid of requestor" type="text"/><a class="btn" onclick="postnewridewithrider();">Post a Ride (match with existing request)</a></div>
<br/>
</div>

<div style="padding:10px;"><b>JSON result here</b><br/>
   <div class="inset" id="jsonresult"></div>	
   <br/>
   <br/>
   <a href="http://www.jsonlint.com" target="json">copy and paste into jsonlint</a>
</div>

</body></html>